# This is mostly a copy from the 14.04 profile, until we have time to do
# a proper profile

grep:
  whitelist:
    disable_mount_cramfs:
      data:
        Ubuntu-16.04:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: cramfs
            grep_args:
              - '-r'
            tag: CIS-1.1.1.1
      description: Ensure mounting of cramfs filesystems is disabled
    disable_mount_freevxfs:
      data:
        Ubuntu-16.04:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: freevxfs
            grep_args:
              - '-r'
            tag: CIS-1.1.1.2
      description: Ensure mounting of freevxfs filesystems is disabled
    disable_mount_jffs2:
      data:
        Ubuntu-16.04:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: jffs2
            grep_args:
              - '-r'
            tag: CIS-1.1.1.3
      description: Ensure mounting of jffs2 filesystems is disabled
    disable_mount_hfs:
      data:
        Ubuntu-16.04:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: hfs
            grep_args:
              - '-r'
            tag: CIS-1.1.1.4
      description: Ensure mounting of hfs filesystems is disabled
    disable_mount_hfsplus:
      data:
        Ubuntu-16.04:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: hfsplus
            grep_args:
              - '-r'
            tag: CIS-1.1.1.5
      description: Ensure mounting of hfsplus filesystems is disabled
    disable_mount_squashfs:
      data:
        Ubuntu-16.04:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: squashfs
            grep_args:
              - '-r'
            tag: CIS-1.1.1.6
      description: Ensure mounting of squashfs filesystems is disabled
    disable_mount_udf:
      data:
        Ubuntu-16.04:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: udf
            grep_args:
              - '-r'
            tag: CIS-1.1.1.7
      description: Ensure mounting of udf filesystems is disabled
    disable_mount_fat:
      data:
        Ubuntu-16.04:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: vfat
            grep_args:
              - '-r'
            tag: CIS-1.1.1.8
      description: Ensure mounting of FAT filesystems is disabled
    mounts_dev_shm_partition_nodev:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            match_output: nodev
            pattern: /dev/shm
            tag: CIS-1.1.14
      description: Add nodev Option to /dev/shm Partition
    mounts_dev_shm_partition_noexec:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            match_output: noexec
            pattern: /dev/shm
            tag: CIS-1.1.16
      description: Add noexec Option to /dev/shm Partition
    mounts_dev_shm_partition_nosuid:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            match_output: nosuid
            pattern: /dev/shm
            tag: CIS-1.1.15
      description: Add nosuid Option to /dev/shm Partition
    mounts_home_partition:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            pattern: /home
            tag: CIS-1.1.12
      description: Create Separate Partition for /home
    mounts_home_partition_nodev:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            match_output: nodev
            pattern: /home
            tag: CIS-1.1.13
      description: Add nodev Option to /home
    mounts_tmp_partition:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            pattern: /tmp
            tag: CIS-1.1.2
      description: Create Separate Partition for /tmp
    mounts_tmp_partition_nodev:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            match_output: nodev
            pattern: /tmp
            tag: CIS-1.1.3
      description: Set nodev option for /tmp Partition
#    mounts_tmp_partition_noexec: #No Check in latest CIS Benchmark
#      data:
#        Ubuntu-16.04:
#        - /proc/mounts:
#            match_output: noexec
#            pattern: /tmp
#            tag: CIS-1.1.4
#      description: Set noexec option for /tmp Partition
    mounts_tmp_partition_nosuid:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            match_output: nosuid
            pattern: /tmp
            tag: CIS-1.1.4
      description: Set nosuid option for /tmp Partition
    mounts_var_log_audit_partition:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            pattern: /var/log/audit
            tag: CIS-1.1.11
      description: Create Separate Partition for /var/log/audit
    mounts_var_log_partition:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            pattern: /var/log
            tag: CIS-1.1.10
      description: Create Separate Partition for /var/log
    mounts_var_partition:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            pattern: /var
            tag: CIS-1.1.5
      description: Create Separate Partition for /var
    fstab_var_tmp_bind_mount:
      data:
        Ubuntu-16.04:
        - /etc/fstab:
            match_output: /var/tmp
            pattern: /var
            tag: CIS-1.1.6
      description: Bind Mount the /var/tmp directory to /tmp
    mount_var_tmp_partition_nodev:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            match_output: nodev
            pattern: /var/tmp
            tag: CIS-1.1.7
      description: Set nodev option for /var/tmp Partition
    mount_var_tmp_partition_nosuid:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            match_output: nosuid
            pattern: /var/tmp
            tag: CIS-1.1.8
      description: Set nosuid option for /var/tmp Partition
    mount_var_tmp_partition_noexec:
      data:
        Ubuntu-16.04:
        - /proc/mounts:
            match_output: noexec
            pattern: /var/tmp
            tag: CIS-1.1.9
      description: Set noexec option for /var/tmp Partition
    aide_filesystem_scans:
      data:
        Ubuntu-16.04:
        - /var/spool/cron/crontabs/root:
            match_output: '0 5 * * * /usr/bin/aide --check'
            pattern: aide
            tag: CIS-1.3.2
      description: Ensure filesystem integrity is regularly checked
    grub_password:
      data:
        Ubuntu-16.04:
        - /boot/grub/grub.cfg:
            pattern: password
            tag: CIS-1.4.2
      description: Set Boot Loader Password
    core_hard_limit:
      data:
        Ubuntu-16.04:
        - /etc/security/limits.conf:
            match_output: '0'
            pattern: hard core
            tag: CIS-1.5.1
      description: Restrict Core Dumps
    ntp_restrict_default:
      data:
        Ubuntu-16.04:
        - /etc/ntp.conf:
            pattern: '^restrict'
            match_output: default
            tag: CIS-2.2.1.2
        - /etc/ntp.conf:
            pattern: restrict -6 default
            tag: CIS-2.2.1.2
        - /etc/ntp.conf:
            pattern: '^server'
            tag: CIS-2.2.1.2
        - /etc/init.d/ntp:
            pattern: RUNASUSER=
            tag: CIS-2.2.1.2
      description: Configure Network Time Protocol (NTP)
    configure_chrony:
      data:
        Ubuntu-16.04:
        - /etc/chrony/chrony.conf:
            tag: CIS-2.2.1.3
            pattern: '^server'
            match_output: 'server *'
            match_output_regex: True
        - /etc/chrony/chrony.conf:
            tag: CIS-2.2.1.3
            pattern: ^user
            match_output: '_chrony'
      description: Ensure chrony is configured
    local_mta:
      data:
        Ubuntu-16.04:
          - /etc/postfix/main.cf:
              pattern: '^inet_interfaces'
              match_output: localhost
              tag: CIS-2.2.15
      description: Configure Mail Transfer Agent for Local-Only Mode
    rsync:
      data:
        Ubuntu-16.04:
        - /etc/default/rsync:
            pattern: ^RSYNC_ENABLE
            match_output: 'false'
            tag: CIS-2.2.16
      description: Ensure rsync service is not enabled
    hosts_allow:
      data:
        Ubuntu-16.04:
        - /etc/hosts.allow:
            pattern: ALL
            tag: CIS-3.4.2
      description: Ensure /etc/hosts.allow is configured
    hosts_deny:
      data:
        Ubuntu-16.04:
        - /etc/hosts.deny:
            pattern:  ALL
            tag: CIS-3.4.3
      description: Ensure /etc/hosts.deny is configured
    firewall_default_deny:
      data:
        Ubuntu-16.04:
        - /etc/iptables/rules.v4:
            pattern: :INPUT
            match_output: DROP
            tag: CIS-3.6.2
        - /etc/iptables/rules.v4:
            pattern: :FORWARD
            match_pattern: DROP
            tag: CIS-3.6.2
        - /etc/iptables/rules.v4:
            pattern: :OUTPUT
            match_output: DROP
            tag: CIS-3.6.2
      description: Ensure default deny firewall policy
    firewall_accept_lo:
      data:
        Ubuntu-16.04:
        - /etc/iptables/rules.v4:
            pattern: '"\-A INPUT \-i lo \-j"'
            match_output: ACCEPT
            tag: CIS-3.6.3
        - /etc/iptables/rules.v4:
            pattern: '"\-A OUTPUT \-o lo \-j"'
            match_output: ACCEPT
            tag: CIS-3.6.3
        - /etc/iptables/rules.v4:
            pattern: '"\-A INPUT \-s 127.0.0.0/8 \-j"'
            match_output: DROP
            tag: CIS-3.6.3
      description: Ensure loopback traffic is configured
#3.6.5 is not implemented as need code changes
    rsyslog_file_perms:
      data:
        Ubuntu-16.04:
        - /etc/rsyslog.conf:
            pattern: '^\$FileCreateMode'
            match_output: '0640'
            tag: CIS-4.2.1.3
      description: Create and Set Permissions on rsyslog Log Files
    rsyslog_remote_logging:
      data:
        Ubuntu-16.04:
        - /etc/rsyslog.conf:
            pattern: ^*.*[^I][^I]*@
            tag: CIS-4.2.1.4
      description: Configure rsyslog to Send Logs to a Remote Log Host
#CIS-4.2.2.1 is only applicable if we have syslog-ng package installed
#CIS-4.2.2.3 is only applicable if we have syslog-ng package installed
#CIS-4.2.2.4 is only applicable if we have syslog-ng package installed
    pam_cracklib_settings:
      data:
        Ubuntu-16.04:
        - /etc/pam.d/common-password:
            pattern: pam_cracklib
            match_output: 'retry=3'
            tag: CIS-9.2.1
        - /etc/pam.d/common-password:
            pattern: pam_cracklib
            match_output: 'minlen=14'
            tag: CIS-9.2.1
        - /etc/pam.d/common-password:
            pattern: pam_cracklib
            match_output: 'dcredit=-1'
            tag: CIS-9.2.1
        - /etc/pam.d/common-password:
            pattern: pam_cracklib
            match_output: 'ucredit=-1'
            tag: CIS-9.2.1
        - /etc/pam.d/common-password:
            pattern: pam_cracklib
            match_output: 'ocredit=-1'
            tag: CIS-9.2.1
        - /etc/pam.d/common-password:
            pattern: pam_cracklib
            match_output: 'lcredit=-1'
            tag: CIS-9.2.1
      description: Set Password Creation Requirement Parameters Using pam_cracklib
    pam_password_reuse:
      data:
        Ubuntu-16.04:
        - /etc/pam.d/common-password:
            pattern: remember
            match_output: 'remember=5'
            tag: CIS-5.3.3
      description: Limit Password Reuse
    ssh_version_2:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: Protocol
            match_output: '2'
            tag: CIS-5.2.2
      description: Set SSH Protocol to 2
    ssh_log_level:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: LogLevel
            match_output: INFO
            tag: CIS-5.2.3
      description: Set LogLevel to INFO
    ssh_disable_xforward:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: X11Forwarding
            match_output: 'no'
            tag: CIS-5.2.4
      description: Disable SSH X11 Forwarding
    ssh_auth_retries:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: MaxAuthTries
            match_output_regex: True
            match_output: "^MaxAuthTries +[1-4]$"
            tag: CIS-5.2.5
      description: Set SSH MaxAuthTries to 4 or Less
    ssh_ignore_rhosts:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: IgnoreRhosts
            match_output: 'yes'
            tag: CIS-5.2.6
      description: Set SSH IgnoreRhosts to Yes
    ssh_hostbased_auth:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: HostbasedAuthentication
            match_output: 'no'
            tag: CIS-5.2.7
      description: Set SSH HostbasedAuthentication to No
    ssh_permit_root:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: PermitRootLogin
            match_output: 'no'
            tag: CIS-5.2.8
      description: Disable SSH Root Login
    ssh_permit_empty_pw:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: PermitEmptyPasswords
            match_output: 'no'
            tag: CIS-5.2.9
      description: Set SSH PermitEmptyPasswords to No
    ssh_permit_user_env:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: PermitUserEnvironment
            match_output: 'no'
            tag: CIS-5.2.10
      description: Do Not Allow Users to Set Environment Options
    ssh_restrict_cipher:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: Ciphers
            match_output: '^Ciphers aes256-ctr,aes192-ctr,aes128-ctr$|^Ciphers aes256-ctr,aes128-ctr,aes192-ctr$|^Ciphers aes192-ctr,aes128-ctr,aes256-ctr$|^Ciphers aes192-ctr,aes256-ctr,aes128-ctr$|^Ciphers aes128-ctr,aes256-ctr,aes192-ctr$|^Ciphers aes128-ctr,aes192-ctr,aes256-ctr$'
            match_output_regex: True
            tag: CIS-5.2.11
      description: Use Only Approved Cipher in Counter Mode
    sshd_idle_timeout:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: ClientAliveInterval
            match_output: ^ClientAliveInterval +([1-2]{0,1}\d{1,2}|300)$
            match_output_regex: True
            tag: CIS-5.2.12
        - /etc/ssh/sshd_config:
            pattern: ClientAliveCountMax
            match_output: "^ClientAliveCountMax +[0-3]$"
            match_output_regex: True
            tag: CIS-5.2.12
      description: Set Idle Timeout Interval for User Login
    sshd_gracetime:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: ^LoginGraceTime
            match_output: ^LoginGraceTime ([0-5]{0,1}\d|60|1m)$
            match_output_regex: True
            tag: CIS-5.2.13
      description: Ensure SSH LoginGraceTime is set to one minute or less
    ssh_limit_access:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            pattern: AllowUsers
            tag: CIS-5.2.14
        - /etc/ssh/sshd_config:
            pattern: AllowGroups
            tag: CIS-5.2.14
        - /etc/ssh/sshd_config:
            pattern: DenyUsers
            tag: CIS-5.2.14
        - /etc/ssh/sshd_config:
            pattern: DenyGroups
            tag: CIS-5.2.14
      description:  Limit Access via SSH
    sshd_banner:
      data:
        Ubuntu-16.04:
        - /etc/ssh/sshd_config:
            match_output: "/etc/issue.net"
            pattern: ^Banner
            tag: CIS-5.2.16
      description: Ensure SSH warning banner is configured
    pam_pwquality_try_first_pass:
      data:
        Ubuntu-16.04:
        - /etc/pam.d/system-auth:
            match_output: try_first_pass
            pattern: pam_pwquality.so
            tag: CIS-5.3.1
        - /etc/pam.d/system-auth:
            match_output: retry=3
            pattern: pam_pwquality.so
            tag: CIS-5.3.1
        - /etc/security/pwquality.conf:
            pattern: minlen
            match_output: '14'
            tag: CIS-5.3.1
        - /etc/security/pwquality.conf:
            pattern: dcredit
            match_output: '-1'
            tag: CIS-5.3.1
        - /etc/security/pwquality.conf:
            pattern: ucredit
            match_output: '-1'
            tag: CIS-5.3.1
        - /etc/security/pwquality.conf:
            pattern: ocredit
            match_output: '-1'
            tag: CIS-5.3.1
        - /etc/security/pwquality.conf:
            pattern: lcredit
            match_output: '-1'
            tag: CIS-5.3.1
      description: Ensure password creation requirements are configured
    password_hash:
      data:
        Ubuntu-16.04:
        - /etc/pam.d/password-auth:
            pattern: '"^password\s+\w+\s+pam_unix\.so"'
            match_output: sha512
            grep_args:
              - '-E'
            tag: CIS-5.3.4
      description: Ensure password hashing algorithm is SHA-512
    limit_su_access:
      data:
        Ubuntu-16.04:
        - /etc/pam.d/su:
            pattern: pam_wheel.so
            match_output: use_uid
            tag: CIS-5.6
        - /etc/group:
            pattern: wheel
            tag: CIS-5.6
      description: Restrict Access to the su Command
    password_max_days:
      data:
        Ubuntu-16.04:
        - /etc/login.defs:
            pattern: PASS_MAX_DAYS
            match_output: '90'
            tag: CIS-5.4.1.1
      description: Set Password Expiration Days
    password_min_days:
      data:
        Ubuntu-16.04:
        - /etc/login.defs:
            pattern: PASS_MIN_DAYS
            match_output: '7'
            tag: CIS-5.4.1.2
      description: Set Password Change Minimum Number of Days
    password_warn_days:
      data:
        Ubuntu-16.04:
        - /etc/login.defs:
            pattern: PASS_WARN_AGE
            match_output: '7'
            tag: CIS-5.4.1.3
      description: Set Password Expiring Warning Days
    default_umask:
      data:
        Ubuntu-16.04:
        - /etc/bashrc:
            pattern: umask
            match_pattern: '027'
            tag: CIS-5.4.4
        - /etc/profile:
            pattern: umask
            match_pattern: '027'
            tag: CIS-5.4.4
      description: Ensure default user umask is 027 or more restrictive 
#    umask:
#      data:
#        Ubuntu-16.04:
#        - /etc/login.defs:
#            pattern: UMASK
#            match_output: '077'
#            tag: CIS-10.4
      description: Set Default umask for Users
  blacklist:
    root_passwd_set:
      data:
        Ubuntu-16.04:
        - /etc/shadow:
            pattern: '^root:[*\!]:'
            tag: CIS-1.4.3
      description: Require Authentication for Single-User Mode
#    selinux_boot_enabled: #L2 Check so disabled
#      data:
#        Ubuntu-16.04:
#        - /boot/grub/grub.cfg:
#            match_output: '0'
#            pattern: 'selinux'
#            tag: CIS-1.6.1.1
#        - /boot/grub/grub.cfg:
#            match_output: '0'
#            pattern: 'enforcing'
#            tag: CIS-1.6.1.1
# CIS-1.7.2 is not applicable as we are not using linux in graphical mode
#      description: Ensure SELinux is not disabled in bootloader configuration
#    rsh_inet:
#      data:
#        Ubuntu-16.04:
#        - /etc/inetd.conf:
#            pattern: '^shell'
#            tag: CIS-5.1.2
#        - /etc/inetd.conf:
#            pattern: '^login'
#            tag: CIS-5.1.2
#        - /etc/inetd.conf:
#            pattern: '^exec'
#            tag: CIS-5.1.2
#      description: Ensure rsh server is not enabled
    talkd:
      data:
        Ubuntu-16.04:
        - /etc/xinetd*:
            pattern: '^talk'
            grep_args:
              - '-r'
            tag: CIS-2.1.7
        - /etc/xinetd*:
            pattern: '^ntalk'
            grep_args:
              - '-r'
            tag: CIS-2.1.7
      description: Ensure talk server is not enabled
    telnet:
      data:
        Ubuntu-16.04:
        - /etc/xinetd*:
            pattern: '^telnet'
            greps_args:
              - '-r'
            tag: CIS-2.1.8
      description: Ensure Telnet Server is not Enabled
    tftp:
      data:
        Ubuntu-16.04:
        - /etc/xinetd*:
            pattern: '^tftp'
            grep_args:
              - '-r'
            tag: CIS-2.1.9
      description: Ensure tftp-server is not enabled
    chargen:
      data:
        Ubuntu-16.04:
        - /etc/xinetd.d/chargen:
            match_output: '^\s*disable\s*=\s*no'
            pattern: chargen-stream
            match_output_regex: True
            grep_args:
              - '-B'
              - '3'
            tag: CIS-2.1.1
        - /etc/xinetd.d/chargen:
            match_output: '^\s*disable\s*=\s*no'
            pattern: chargen-dgram
            match_output_regex: True
            grep_args:
              - '-B'
              - '3'
            tag: CIS-2.1.1
      description: Ensure Chargen is not Enabled

#    chargen:
#      data:
#        Ubuntu-16.04:
#        - /etc/xinetd.d/chargen:
#            match_output: 'disable'
#            pattern: 'chargen-stream'
#            grep-args:
#              - '-B 3'
#            tag: CIS-2.1.1
#      description: Ensure Chargen is not Enabled
    daytime:
      data:
        Ubuntu-16.04:
        - /etc/xinetd.d/daytime:
            match_output: '^\s*disable\s*=\s*no'
            pattern: daytime-stream
            match_output_regex: True
            grep_args:
              - '-B'
              - '3'
            tag: CIS-2.1.2
        - /etc/xinetd.d/daytime:
            match_output: '^\s*disable\s*=\s*no'
            pattern: daytime-dgram
            match_output_regex: True
            grep_args:
              - '-B'
              - '3'
            tag: CIS-2.1.2
      description: Ensure daytime is not Enabled
#    daytime:
#      data:
#        Ubuntu-16.04:
#        - /etc/inetd.conf:
#            pattern: '^daytime'
#            tag: CIS-5.3
#      description: Ensure daytime is not Enabled
    echo:
      data:
        Ubuntu-16.04:
        - /etc/xinetd.d/echo:
            match_output: '^\s*disable\s*=\s*no'
            pattern: echo-stream
            match_output_regex: True
            grep_args:
              - '-B'
              - '3'
            tag: CIS-2.1.4
        - /etc/xinetd.d/echo:
            match_output: '^\s*disable\s*=\s*no'
            pattern: echo-dgram
            match_output_regex: True
            grep_args:
              - '-B'
              - '3'
            tag: CIS-2.1.4
      description: Ensure echo is not Enabled 
#    echo:
#      data:
#        Ubuntu-16.04:
#        - /etc/inetd.conf:
#            pattern: '^echo'
#            tag: CIS-5.4
#      description: Ensure echo is not Enabled
    discard:
      data:
        Ubuntu-16.04:
        - /etc/xinetd.d/discard:
            match_output: '^\s*disable\s*=\s*no'
            pattern: discard-stream
            match_output_regex: True
            grep_args:
              - '-B'
              - '3'
            tag: CIS-2.1.3
        - /etc/xinetd.d/discard:
            match_output: '^\s*disable\s*=\s*no'
            pattern: discard-dgram
            match_output_regex: True
            grep_args:
              - '-B'
              - '3'
            tag: CIS-2.1.3
      description: Ensure discard is not Enabled
#    discard:
#      data:
#        Ubuntu-16.04:
#        - /etc/inetd.conf:
#            pattern: '^discard'
#            tag: CIS-5.5
#      description: Ensure discard is not Enabled
    time:
      data:
        Ubuntu-16.04:
        - /etc/xinetd.d/time:
            match_output: '^\s*disable\s*=\s*no'
            pattern: time-stream
            match_output_regex: True
            grep_args:
              - '-B'
              - '3'
            tag: CIS-2.1.5
        - /etc/xinetd.d/time:
            match_output: '^\s*disable\s*=\s*no'
            pattern: time-dgram
            match_output_regex: True
            grep_args:
              - '-B'
              - '3'
            tag: CIS-2.1.5
      description: Ensure time is not Enabled
#    time:
#      data:
#        Ubuntu-16.04:
#        - /etc/inetd.conf:
#            pattern: '^time'
#            tag: CIS-5.6
#      description: Ensure time is not Enabled
    banner_os_info_motd:
      data:
        Ubuntu-16.04:
        - /etc/motd:
            pattern: '\v'
            tag: CIS-1.7.1.1
        - /etc/motd:
            pattern: '\r'
            tag: CIS-1.7.1.1
        - /etc/motd:
            pattern: '\m'
            tag: CIS-1.7.1.1
        - /etc/motd:
            pattern: '\s'
            tag: CIS-1.7.1.1
      description: Remove OS Information from Login Warning Banners
    banner_os_info_issue:
      data:
        Ubuntu-16.04:
        - /etc/issue:
            pattern: '\v'
            tag: CIS-1.7.1.2
        - /etc/issue:
            pattern: '\r'
            tag: CIS-1.7.1.2
        - /etc/issue:
            pattern: '\m'
            tag: CIS-1.7.1.2
        - /etc/issue:
            pattern: '\s'
            tag: CIS-1.7.1.2
      description: Remove OS Information from Login Warning Banners
    banner_os_info_issue_net:
      data:
        Ubuntu-16.04:
        - /etc/issue.net:
            pattern: '\v'
            tag: CIS-1.7.1.3
        - /etc/issue.net:
            pattern: '\r'
            tag: CIS-1.7.1.3
        - /etc/issue.net:
            pattern: '\m'
            tag: CIS-1.7.1.3
        - /etc/issue.net:
            pattern: '\s'
            tag: CIS-1.7.1.3
      description: Remove OS Information from Login Warning Banners
    legacy_entries_passwd:
      data:
        Ubuntu-16.04:
        - /etc/passwd:
            pattern: '^+'
            tag: CIS-6.2.2
      description: Verify No Legacy "+" Entries Exist in /etc/passwd File
    legacy_entries_shadow:
      data:
        Ubuntu-16.04:
        - /etc/shadow:
            pattern: '^+'
            tag: CIS-6.2.3
      description: Verify No Legacy "+" Entries Exist in /etc/shadow File
    legacy_entries_group:
      data:
        Ubuntu-16.04:
        - /etc/group:
            pattern: '^+'
            tag: CIS-6.2.4
      description: Verify No Legacy "+" Entries Exist in /etc/group File

service:
  blacklist:
    autofs:
      data:
        Ubuntu-16.04:
        - autofs: CIS-1.1.21
      description: Disable Automounting
    apport:
      data:
        Ubuntu-16.04:
        - apport: CIS-4.1
      description: Restrict Core Dumps
    whoopsie:
      data:
        Ubuntu-16.04:
        - whoopsie: CIS-4.1
      description: Restrict Core Dumps
    xinetd:
      data:
        Ubuntu-16.04:
          - xinetd: CIS-2.1.10
      description: Ensure xinetd is not enabled
    avahi_daemon:
      data:
        Ubuntu-16.04:
          - avahi-daemon: CIS-2.2.3
      description: Ensure Avahi Server is not enabled
    cups:
      data:
        Ubuntu-16.04:
          - cups: CIS-2.2.4
      description: Ensure print server is not enabled
    dhcp-server:
      data:
        Ubuntu-16.04:
          - isc-dhcp-server: CIS-2.2.5
          - isc-dhcp-server6: CIS-2.2.5
      description: Ensure DHCP Server is not enabled
    slapd:
      data:
        Ubuntu-16.04:
        - slapd: CIS-2.2.6
      description: Ensure LDAP server is not enabled
    nfs-service:
      data:
        Ubuntu-16.04:
        - nfs-kernel-server: CIS-2.2.7
      description: Ensure NFS and RPC are not enabled(nfs-service)
    rpc-bind-service:
      data:
        Ubuntu-16.04:
        - rpcbind: CIS-2.2.7
      description: Ensure NFS and RPC are not enabled(rpcbind-service)
    bind9:
      data:
        Ubuntu-16.04:
        - bind9: CIS-2.2.8
      description: Ensure DNS Server is not enabled(bind9-service)
    http-server-service:
      data:
        Ubuntu-16.04:
        - apache2: CIS-2.2.10
      description: Ensure HTTP server is not enabled(Apache2-service)
    imap-pop3-server-service:
      data:
        Ubuntu-16.04:
        - dovecot: CIS-2.2.11
      description: Ensure IMAP and POP3 server is not enabled(imap-pop3-service)

  whitelist:
    rsyslog:
      data:
        Ubuntu-16.04:
          - rsyslog: CIS-4.2.1.1
      description: Ensure the rsyslog Service is activated(rsyslog-service)
    cron:
      data:
        Ubuntu-16.04:
          - cron: CIS-5.1.1
      description: Enable cron Daemon
#    chargen_disabled: #Not working so disabled
#      data:
#        Ubuntu-16.04:
#        - chargen-dgram: CIS-2.1.1
#        - chargen-stream: CIS-2.1.1
#      description: Ensure chargen services are not enabled

sysctl:
  disable_suid_dumpable:
    data:
      Ubuntu-16.04:
      - fs.suid_dumpable:
          match_output: '0'
          tag: CIS-1.5.1
    description: Restrict Core Dumps
  randomize_va_space:
    data:
      Ubuntu-16.04:
      - kernel.randomize_va_space:
          match_output: '2'
          tag: CIS-1.5.3
    description: Ensure address space layout randomization (ASLR) is enabled
  disable_ip4_ip_forward:
    data:
      Ubuntu-16.04:
      - net.ipv4.ip_forward:
          match_output: '0'
          tag: CIS-3.1.1
    description: Disable IP Forwarding
  disable_packet_redirect:
    data:
      Ubuntu-16.04:
      - net.ipv4.conf.all.send_redirects:
          match_output: '0'
          tag: CIS-3.1.2
    description: Disable Send Packet Redirects
  disable_source_routed_packets:
    data:
      Ubuntu-16.04:
      - net.ipv4.conf.all.accept_source_route:
          match_output: '0'
          tag: CIS-3.2.1
    description: Disable Source Routed Packet Acceptance
  disable_icmp_redirect:
    data:
      Ubuntu-16.04:
      - net.ipv4.conf.all.accept_redirects:
          match_output: '0'
          tag: CIS-3.2.2
    description: Disable ICMP Redirect Acceptance
  disable_secure_icmp_redirect:
    data:
      Ubuntu-16.04:
      - net.ipv4.conf.all.secure_redirects:
          match_output: '0'
          tag: CIS-3.2.3
    description: Disable Secure ICMP Redirect Acceptance
  log_martians:
    data:
      Ubuntu-16.04:
      - net.ipv4.conf.all.log_martians:
          match_output: '1'
          tag: CIS-3.2.4
    description: Log Suspicious Packets
  ignore_broadcast:
    data:
      Ubuntu-16.04:
      - net.ipv4.icmp_echo_ignore_broadcasts:
          match_output: '1'
          tag: CIS-3.2.5
    description: Enable Ignore Broadcast Requests
  bogus_errors:
    data:
      Ubuntu-16.04:
      - net.ipv4.icmp_ignore_bogus_error_responses:
          match_output: '1'
          tag: CIS-3.2.6
    description: Enable Bad Error Message Protection
  rp_filter:
    data:
      Ubuntu-16.04:
      - net.ipv4.conf.all.rp_filter:
          match_output: '1'
          tag: CIS-3.2.7
    description: Enable RFC-recommended Source Route Validation
  tcp_syncookies:
    data:
      Ubuntu-16.04:
      - net.ipv4.tcp_syncookies:
          match_output: '1'
          tag: CIS-3.2.8
    description: Enable TCP SYN Cookies

pkg:
  blacklist:
    prelink:
      data:
        Ubuntu-16.04:
        - prelink: CIS-1.5.4
      description: Disable Prelink
    nis:
      data:
        Ubuntu-16.04:
        - nis: CIS-2.3.1
      description: Ensure NIS is not installed
    talkd:
      data:
        Ubuntu-16.04:
        - talkd: CIS-2.1.7
      description: Ensure Talk Server is not installed
    telnet-server:
      data:
        Ubuntu-16.04:
        - telnetd: CIS-2.1.8
      description: Ensure Telnet Server is not installed
    telnet-client:
      data:
        Ubuntu-16.04:
        - telnet: CIS-2.3.4
      description: Ensure Telnet Client is not installed
    ldap-client:
      data:
        Ubuntu-16.04:
        - ldap-utils: CIS-2.3.5
      description: Ensure LDAP Client is not installed
    talk:
      data:
        Ubuntu-16.04:
        - talk: CIS-2.3.3
      description: Ensure Talk Client is not installed
    xserver:
      data:
        Ubuntu-16.04:
        - xserver-xorg-core\*: CIS-2.2.2
      description: Ensure the X Window system is not installed
    biosdevname:
      data:
        Ubuntu-16.04:
        - biosdevname: CIS-6.17
      description: Ensure biosdevname is not enabled
    rsh-server:
      data:
        Ubuntu-16.04:
        - rsh-server: CIS-2.1.6
      description: Ensure rsh server is not enabled
  whitelist:
    ntp:
      data:
        Ubuntu-16.04:
        - ntp: CIS-2.2.1.2
      description: Configure Network Time Protocol (NTP)
    aide:
      data:
        Ubuntu-16.04:
        - aide: CIS-1.3.1
      description: Ensure AIDE is installed
    tcpd:
      data:
        Ubuntu-16.04:
        - tcpd: CIS-3.4.1
      description: Install TCP Wrappers
    rsyslog:
      data:
        Ubuntu-16.04:
        - rsyslog: CIS-4.2.3
      description: Install the rsyslog package
#CIS-4.2.4 is not implemented as need code side changes
    iptables:
      data:
        Ubuntu-16.04:
        - iptables: CIS-3.6.1
      description: Ensure iptables is installed
stat:
  grub_cfg_owner:
    data:
      Ubuntu-16.04:
      - /boot/grub/grub.cfg:
          gid: 0
          group: root
          uid: 0
          user: root
          tag: CIS-1.4.1
    description: Set User/Group Owner on bootloader config
  grub_cfg_perms:
    data:
      Ubuntu-16.04:
      - /boot/grub/grub.cfg:
          mode: 600
          tag: CIS-1.4.1
    description: Set Permissions on bootloader config
  hosts_allow_perms:
    data:
      Ubuntu-16.04:
      - /etc/hosts.allow:
          gid: 0
          group: root
          mode: 644
          tag: CIS-3.4.4
          uid: 0
          user: root
          tag: CIS-3.4.4
    description: Verify Permissions on /etc/hosts.allow
  hosts_deny_perms:
    data:
      Ubuntu-16.04:
      - /etc/hosts.deny:
          gid: 0
          group: root
          mode: 644
          tag: CIS-3.4.4
          uid: 0
          user: root
          tag: CIS-3.4.5
    description: Verify Permissions on /etc/hosts.deny
  crontab_own_perms:
    data:
      Ubuntu-16.04:
      - /etc/crontab:
          gid: 0
          group: root
          uid: 0
          user: root
          mode: 600
          tag: CIS-5.1.2
    description:  Set User/Group Owner and Permission on /etc/crontab
  cron_hourly_own_perms:
    data:
      Ubuntu-16.04:
      - /etc/cron.hourly:
          gid: 0
          group: root
          uid: 0
          user: root
          mode: 600
          tag: CIS-5.1.3
    description:  Set User/Group Owner and Permission on /etc/cron.hourly
  cron_daily_own_perms:
    data:
      Ubuntu-16.04:
      - /etc/cron.daily:
          gid: 0
          group: root
          uid: 0
          user: root
          mode: 600
          tag: CIS-5.1.4
    description:  Set User/Group Owner and Permission on /etc/cron.daily
  cron_weekly_own_perms:
    data:
      Ubuntu-16.04:
      - /etc/cron.weekly:
          gid: 0
          group: root
          uid: 0
          user: root
          mode: 600
          tag: CIS-5.1.5
    description:  Set User/Group Owner and Permission on /etc/cron.weekly
  cron_monthly_own_perms:
    data:
      Ubuntu-16.04:
      - /etc/cron.monthly:
          gid: 0
          group: root
          uid: 0
          user: root
          mode: 600
          tag: CIS-5.1.6
    description:  Set User/Group Owner and Permission on /etc/cron.monthly
  cron_d_own_perms:
    data:
      Ubuntu-16.04:
      - /etc/cron.d:
          gid: 0
          group: root
          uid: 0
          user: root
          mode: 700
          tag: CIS-5.1.7
    description:  Set User/Group Owner and Permission on /etc/cron.d
  at_cron_allow:
    data:
      Ubuntu-16.04:
      - /etc/cron.deny:
          gid: null
          group: null
          mode: null
          tag: CIS-5.1.8
          uid: null
          user: null
      - /etc/at.deny:
          gid: null
          group: null
          mode: null
          tag: CIS-5.1.8
          uid: null
          user: null
      - /etc/cron.allow:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.1.8
          uid: 0
          user: root
      - /etc/at.allow:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.1.8
          uid: 0
          user: root
    description: Restrict at/cron to authorized users
  sshd_config:
    data:
      Ubuntu-16.04:
      - /etc/ssh/sshd_config:
          uid: 0
          gid: 0
          user: root
          group: root
          mode: 600
          tag: CIS-5.2.1
    description: Set Permissions on /etc/ssh/sshd_config
  banner_files_motd:
    data:
      Ubuntu-16.04:
      - /etc/motd:
          uid: 0
          gid: 0
          user: root
          group: root
          mode: 644
          tag: CIS-1.7.1.4
    description: Set Warning Banner for Standard Login Services
  banner_files_issue:
    data:
      Ubuntu-16.04:
      - /etc/issue:
          uid: 0
          gid: 0
          user: root
          group: root
          mode: 644
          tag: CIS-1.7.1.5
    description: Set Warning Banner for Standard Login Services
  banner_files_issue_net:
    data:
      Ubuntu-16.04:
      - /etc/issue.net:
          uid: 0
          gid: 0
          user: root
          group: root
          mode: 644
          tag: CIS-1.7.1.6
    description: Set Warning Banner for Standard Login Services
  passwd_perms:
    data:
      Ubuntu-16.04:
      - /etc/passwd:
          uid: 0
          gid: 0
          user: root
          group: root
          mode: 644
          tag: CIS-6.1.2
    description: Verify Permissions on /etc/passwd
  shadow_perms:
    data:
      Ubuntu-16.04:
      - /etc/shadow:
          uid: 0
          gid: 42
          user: root
          group: shadow
          mode: 640
          tag: CIS-6.1.3
    description: Verify Permissions on /etc/shadow
  group_perms:
    data:
      Ubuntu-16.04:
      - /etc/group:
          uid: 0
          gid: 0
          user: root
          group: root
          mode: 644
          tag: CIS-6.1.4
    description: Verify Permissions on /etc/group
  gshadow_owner_group:
    data:
      Ubuntu-16.04:
      - /etc/gshadow:
          uid: 0
          gid: 42
          user: root
          group: shadow
          tag: CIS-6.1.5
    description: Verify User/Group Ownership on /etc/gshadow
  passwd-_own_perm:
    data:
      Ubuntu-16.04:
      - /etc/passwd-:
          gid: 0
          group: root
          mode: 600
          tag: CIS-6.1.6
          uid: 0
          user: root
    description: Ensure permissions on /etc/passwd- are configured
  shadow-_own_perm:
    data:
      Ubuntu-16.04:
      - /etc/shadow-:
          gid: 0
          group: root
          mode: 600
          tag: CIS-6.1.7
          uid: 0
          user: root
    description: 'Ensure permissions on /etc/shadow- are configured'
  group-_own_perm:
    data:
      Ubuntu-16.04:
      - /etc/group-:
          gid: 0
          group: root
          mode: 600
          tag: CIS-6.1.8
          uid: 0
          user: root
    description: 'Ensure permissions on /etc/group- are configured'
  gshadow-_own_perm:
    data:
      Ubuntu-16.04:
      - /etc/gshadow-:
          gid: 0
          group: root
          mode: 600
          tag: CIS-6.1.9
          uid: 0
          user: root
    description: 'Ensure permissions on /etc/gshadow- are configured'
command:
  rsh_client:
    data:
      Ubuntu-16.04:
        tag: CIS-2.3.2
        commands:
          - 'dpkg -s rsh-client':
              match_output: is not installed
          - 'dpkg -s rsh-redone-client':
              match_output: is not installed
    description: Ensure RSH Client is not Installed
  ufw_active:
    data:
      Ubuntu-16.04:
        tag: CIS-7.7
        commands:
          - 'ufw status':
              match_output: Status active
    description: Ensure Firewall is active
  disable_system_accts:
    data:
      Ubuntu-16.04:
        tag: CIS-5.4.2
        commands:
          - ?
              >
                egrep -v "^\+" /etc/passwd | awk -F: '($1!="root" && $1!="sync"
                && $1!="shutdown" && $1!="halt" && $3<500
                && $7!="/usr/sbin/nologin" && $7!="/bin/false") {print}'
            :
              shell: /bin/bash
              fail_if_matched: true
    description: Ensure system accounts are non-login
  default_root_group:
    data:
      Ubuntu-16.04:
        tag: CIS-10.3
        commands:
          - 'grep "^root:" /etc/passwd | cut -f4 -d:':
              match_output: '0'
    description: Set Default Group for root Account
  inactive_users:
    data:
      Ubuntu-16.04:
        tag: CIS-5.4.1.4
        commands:
          - 'useradd -D | grep INACTIVE':
              match_output: '35'
    description: Lock Inactive User Accounts
#  empty_passwd_field:
#    data:
#      Ubuntu-16.04:
#        tag: CIS-6.2.1
#        commands:
#          - ?
#              >
#                cat /etc/shadow | /usr/bin/awk -F: '($2 == "" ) { print $1 }'
#            :
#              shell: /bin/bash
#              fail_if_matched: true
#    description: Ensure Password Fields are Not Empty
#  uid_zero_only_root:
#    data:
#      Ubuntu-16.04:
#        tag: CIS-13.5
#        commands:
#          - ?
#              >
#                cat /etc/passwd | /usr/bin/awk -F: '($1!="root" && $3==0) { print $1 }'
#            :
#              shell: /bin/bash
#              fail_if_matched: true
#    description: Verify No UID 0 Accounts Exist Other Than root
#  root_path:
#    data:
#      Ubuntu-16.04:
#        tag: CIS-13.6
#        commands:
#          - ?
#              |-
#                if [ "`echo $PATH | grep :: `" != "" ]; then
#                echo "Empty Directory in PATH (::)"
#                fi
#                if [ "`echo $PATH | grep :$`" != "" ]; then
#                echo "Trailing : in PATH"
#                fi
#                p=`echo $PATH | sed -e 's/::/:/' -e 's/:$//' -e 's/:/ /g'`
#                set -- $p
#                while [ "$1" != "" ]; do
#                if [ "$1" = "." ]; then
#                echo "PATH contains ."
#                shift
#                continue
#                fi
#                if [ -d $1 ]; then
#                dirperm=`ls -ldH $1 | cut -f1 -d" "`
#                if [ `echo $dirperm | cut -c6 ` != "-" ]; then
#                echo "Group Write permission set on directory $1"
#                fi
#                if [ `echo $dirperm | cut -c9 ` != "-" ]; then
#                echo "Other Write permission set on directory $1"
#                fi
#                dirown=`ls -ldH $1 | awk '{print $3}'`
#                if [ "$dirown" != "root" ] ; then
#                echo $1 is not owned by root
#                fi
#                else
#                echo $1 is not a directory
#                fi
#                shift
#                done
#            :
#              shell: /bin/bash
#              fail_if_matched: true
#    description: Ensure root PATH Integrity
misc:
  sticky_bit_on_world_writable_directories:
    data:
      Ubuntu-16.04:
        tag: CIS-1.1.20
        function: sticky_bit_on_world_writable_dirs
    description: Ensure sticky bit is set on all world-writable directories
  default_group_for_root_account:
    data:
      Ubuntu-16.04:
        tag: CIS-5.4.3
        function: default_group_for_root
    description: 'Ensure default group for the root account is GID 0'
  no_world_writable_file:
    data:
      Ubuntu-16.04:
        tag: CIS-6.1.10
        function: world_writable_file
    description: Ensure no world writable files exist
  no_unowned_file_or_directories:
    data:
      Ubuntu-16.04:
        tag: CIS-6.1.11
        function: unowned_files_or_dir
    description: Ensure no unowned files or directories exist
  no_ungrouped_file_or_directories:
    data:
      Ubuntu-16.04:
        tag: CIS-6.1.12
        function: ungrouped_files_or_dir
    description: Ensure no ungrouped files or directories exist
  ensure_password_fields_non_empty:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.1
        function: check_password_fields_not_empty
    description: Ensure password fields are not empty
  root_is_only_uid_0_account:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.5
        function: root_is_only_uid_0_account
    description: 'Ensure root is the only UID 0 account'
  check_path_integrity:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.6
        function: check_path_integrity
    description: Ensure root PATH Integrity
  valid_home_directory:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.7
        function: check_all_users_home_directory(1000)
    description: 'Ensure all users home directories exist'
  home_directory_permission:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.8
        function: check_users_home_directory_permissions 
    description: 'Ensure users home directories permissions are 750 or more restrictive'
  user_own_home_directory:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.9
        function: check_users_own_their_home(1000)
    description: Ensure users own their home directories
  check_users_dot_files_not_writable:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.10
        function: check_users_dot_files
    description: Ensure users dot files are not group or world writable
  check_users_not_forward_files:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.11
        function: check_users_forward_files
    description: 'Ensure no users have .forward files'
  check_no_users_netrc_files:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.12
        function: check_users_netrc_files
    description: Ensure no users have .netrc files
  check_netrc_files_not_world_writable:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.13
        function: check_netrc_files_accessibility
    description: 'Ensure users .netrc Files are not group or world accessible'
  check_no_users_have_rhosts_files:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.14
        function: check_users_rhosts_files
    description: Ensure no users have .rhosts files
  check_groups_validity_in_systemfiles:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.15
        function: check_groups_validity
    description: Ensure all groups in /etc/passwd exist in /etc/group
  no_duplicate_sid:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.16
        function: check_duplicate_uids 
    description: Ensure no duplicate UIDs exist
  no_duplicate_gid:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.17
        function: check_duplicate_gids
    description: Ensure no duplicate GIDs exist
  check_duplicate_unames_exist:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.18
        function: check_duplicate_unames
    description: Ensure no duplicate user names exist
  check_duplicate_gnames_exist:
    data:
      Ubuntu-16.04:
        tag: CIS-6.2.19
        function: check_duplicate_gnames
    description: Ensure no duplicate group names exist
systemctl:
  whitelist:
    rsyslog_enabled:
      data:
        Ubuntu-16.04:
        - rsyslog:
           tag: CIS-4.2.1.1
      description: Ensure rsyslog Service is enabled(rsyslog-systemctl)
    cron_deamon_enabled:
      data:
        Ubuntu-16.04:
        - cron:
           tag: CIS-5.1.1
      description: Ensure cron daemon is enabled
  blacklist:
    avahi-daemon-disabled:
      data:
        Ubuntu-16.04:
        - avahi-daemon:
            tag: CIS-2.2.3
      description: Ensure Avahi Server is not enabled
    cups-disabled:
      data:
        Ubuntu-16.04:
        - cups:
            tag: CIS-2.2.4
      description: Ensure CUPS is not enabled
    dhcpd-disabled:
      data:
        Ubuntu-16.04:
        - isc-dhcp-server:
            tag: CIS-2.2.5
      description: Ensure DHCP Server is not enabled
    ldap-server-disabled:
      data:
        Ubuntu-16.04:
        - slapd: CIS-2.2.6
      description: Ensure LDAP server is not enabled
    nfs-disabled:
      data:
        Ubuntu-16.04:
        - nfs-kernel-server: CIS-2.2.7
      description: Ensure NFS and RPC are not enabled(nfs-systemctl)
#    rpc-disabled:
#      data:
#        Ubuntu-16.04:
#        - rpcbind:
#            tag: CIS-2.2.7
#      description: Ensure NFS and RPC are not enabled(rpcbind-systemctl)
    dns-server-disabled:
      data:
        Ubuntu-16.04:
        - bind9:
            tag: CIS-2.2.8
      description: Ensure DNS Server is not enabled(bind9-systemctl)
    ftp-server-disabled:
      data:
        Ubuntu-16.04:
        - vsftpd:
            tag: CIS-2.2.9
        - proftpd:
            tag: CIS-2.2.9
        - pure-ftpd:
            tag: CIS-2.2.9
      description: Ensure FTP Server is not enabled
    http-server-disabled:
      data:
        Ubuntu-16.04:
        - apache2:
            tag: CIS-2.2.10
      description: Ensure HTTP server is not enabled(Apache2-systemctl)
    imap-pop3-server-disabled:
      data:
        Ubuntu-16.04:
        - dovecot:
            tag: CIS-2.2.11
      description: Ensure IMAP and POP3 server is not enabled(imap-pop3-systemctl)
    samba-server-disabled:
      data:
        Ubuntu-16.04:
        - samba:
            tag: CIS-2.2.12
      description: Ensure Samba is not enabled
    http-proxy-server-disabled:
      data:
        Ubuntu-16.04:
        - squid:
            tag: CIS-2.2.13
      description: Ensure HTTP Proxy Server is not enabled
    snmp-server-disabled:
      data:
        Ubuntu-16.04:
        - snmpd:
            tag: CIS-2.2.14
      description: Ensure SNMP Server is not enabled
    nis-server-disabled:
      data:
        Ubuntu-16.04:
        - nis:
            tag: CIS-2.2.17
      description: Ensure NIS Server is not enabled
    rsh-socket-disabled:
      data:
        Ubuntu-16.04:
        - rsh.socket:
            tag: CIS-2.1.6
      description: Ensure rsh Server is not enabled
    rlogin-socket-disabled:
      data:
        Ubuntu-16.04:
        - rlogin.socket:
            tag: CIS-2.1.6
      description: Ensure rsh Server is not enabled
    rexec-socket-disabled:
      data:
        Ubuntu-16.04:
        - rexec.socket:
            tag: CIS-2.1.6
      description: Ensure rsh Server is not enabled
    telnet-server-disabled:
      data:
        Ubuntu-16.04:
        - telnet.socket:
            tag: CIS-2.1.8
      description: Ensure telnet server is not enabled
    tftp-server-disabled:
      data:
        Ubuntu-16.04:
        - tftp.socket:
            tag: CIS-2.2.19
      description: Ensure tftp server is not enabled
    rsync-service-disabled:
      data:
        Ubuntu-16.04:
        - rsync:
            tag: CIS-2.2.16
      description: Ensure rsync service is not enabled
    talk-server-disabled:
      data:
        Ubuntu-16.04:
        - ntalk:
            tag: CIS-2.2.21
      description: Ensure talk server is not enabled
