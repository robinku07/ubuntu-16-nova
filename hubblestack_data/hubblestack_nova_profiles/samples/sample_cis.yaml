# NOTE: This CIS Profile only includes Level 1 Scored Items.
# NOTE: Within this file, there are a few sections that should be tailored to your
#       organization's specific policy.  Search for '# NOTE: ' comments through the file.

pkg:
  blacklist:

    telnet:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'telnet-server': 'CIS-2.1.1'
          - 'telnet': 'CIS-2.1.2'
        'CentOS Linux-7':
          - 'telnet-server': 'CIS-2.1.1'
          - 'telnet': 'CIS-2.1.2'
      description: 'Remove telnet and telnet-server (Scored)'

    rsh:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'rsh-server': 'CIS-2.1.3'
          - 'rsh': 'CIS-2.1.4'
        'CentOS Linux-7':
          - 'rsh-server': 'CIS-2.1.3'
          - 'rsh': 'CIS-2.1.4'
      description: 'Remove rsh and rsh-server (Scored)'

    nis:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'ypbind': 'CIS-2.1.5'
          - 'ypserv': 'CIS-2.1.6'
        'CentOS Linux-7':
          - 'ypbind': 'CIS-2.1.5'
          - 'ypserv': 'CIS-2.1.6'
      description: 'Remove nis client and nis server (Scored)'

    tftp:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'tftp': 'CIS-2.1.7'
          - 'tftp-server': 'CIS-2.1.8'
        'CentOS Linux-7':
          - 'tftp': 'CIS-2.1.7'
          - 'tftp-server': 'CIS-2.1.8'
      description: 'Remove tftp and tftp-server (Scored)'

    talk:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'talk': 'CIS-2.1.9'
          - 'talk-server': 'CIS-2.1.10'
        'CentOS Linux-7':
          - 'talk': 'CIS-2.1.9'
          - 'talk-server': 'CIS-2.1.10'
      description: 'Remove talk and talk-server (Scored)'

    xinetd:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'xinetd': 'CIS-2.1.11'
        'CentOS Linux-7':
          - 'xinetd': 'CIS-2.1.11'
      description: 'Remove xinetd (Scored)'

    xorg-x11-server-common:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'xorg-x11-server-common': 'CIS-3.2'
        'CentOS Linux-7':
          - 'xorg-x11-server-common': 'CIS-3.2'
      description: 'Remove the X Window System (Scored)'

    avahi-daemon:
      data:
        'Red Hat Enterprise Linux Server-6':
         - 'avahi-daemon' : 'CIS-3.3'
        'CentOS Linux-7':
         - 'avahi-daemon' : 'CIS-3.3'
      description: 'Disable Avahi Server (Scored)'

    dhcp:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'dhcp': 'CIS-3.5'
        'CentOS Linux-7':
          - 'dhcp': 'CIS-3.5'
      description: 'Remove DHCP server (Scored)'

  whitelist:

    aide:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'aide': 'CIS-1.3.1'
        'CentOS Linux-7':
          - 'aide': 'CIS-1.3.1'
      description: 'Install AIDE (Scored)'

    iptables:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'iptables': 'CIS-4.7_installed'
      description: 'Install IPtables (Scored)'

    firewalld:
      data:
        'CentOS Linux-7':
          - 'firewalld': 'CIS-4.7_installed'
      description: 'Enable firewalld (Scored)'

    rsyslog:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'rsyslog': 'CIS-5.1.1'
        'CentOS Linux-7':
          - 'rsyslog': 'CIS-5.1.1'
      description: 'Install rsyslog (Scored)'

    anacron:
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'cronie-anacron': 'CIS-6.1.1'
        'CentOS Linux-7':
          - 'cronie-anacron': 'CIS-6.1.1'
      description: 'Enable anacron Daemon (Scored)'

stat:
  grub_conf_own:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/grub.conf':
            tag: 'CIS-1.5.1'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/grub2/grub.cfg':
            tag: 'CIS-1.5.1'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: 'Grub must be owned by root (Scored)'

  grub_conf_perm:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/grub.conf':
            tag: 'CIS-1.5.2'
            mode: 600
      'CentOS Linux-7':
        - '/etc/grub2/grub.cfg':
            tag: 'CIS-1.5.2'
            mode: 600
    description: 'Grub must have permissions 600 (Scored)'

  hosts_allow:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/hosts.allow':
            tag: 'CIS-4.5.3'
            mode: 644
      'CentOS Linux-7':
        - '/etc/hosts.allow':
            tag: 'CIS-4.5.3'
            mode: 644
    description: '/etc/hosts.allow must have permissions 644 (Scored)'

  hosts_deny:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/hosts.deny':
            tag: 'CIS-4.5.5'
            mode: 644
      'CentOS Linux-7':
        - '/etc/hosts.deny':
            tag: 'CIS-4.5.5'
            mode: 644
    description: '/etc/hosts.deny must have persmissions 644 (Scored)'

  anacrontab:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/anacrontab':
            tag: 'CIS-6.1.3'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/anacrontab':
            tag: 'CIS-6.1.3'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/anacrontab file be owned by root and must have permissions 600 (Scored)'

  crontab:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/crontab':
            tag: 'CIS-6.1.4'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/crontab':
            tag: 'CIS-6.1.4'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/crontab must be owned by root and have persmissions 600 (Scored)'

  cron_hourly:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/cron.hourly':
            tag: 'CIS-6.1.5'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.hourly':
            tag: 'CIS-6.1.5'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/cron.hourly must be owned by root and must have permissions 700 (Scored)'

  cron_daily:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/cron.daily':
            tag: 'CIS-6.1.6'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.daily':
            tag: 'CIS-6.1.6'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/cron.daily must be owned by root and must have permissions 700 (Scored)'

  cron_weekly:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/cron.weekly':
            tag: 'CIS-6.1.7'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.weekly':
            tag: 'CIS-6.1.7'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/cron.weekly must be owned by root and must have permissions 700 (Scored)'

  cron_monthly:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/cron.monthly':
            tag: 'CIS-6.1.8'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.monthly':
            tag: 'CIS-6.1.8'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/cron.monthly must be owned by root and must have permissions 700 (Scored)'

  cron_d:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/cron.d':
            tag: 'CIS-6.1.9'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.d':
            tag: 'CIS-6.1.9'
            mode: 700
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/cron.d must be owned by root and must have permissions 700 (Scored)'

  at_allow:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/at.allow':
            tag: 'CIS-6.1.10'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/at.allow':
            tag: 'CIS-6.1.10'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/at.allow must be owned by root and have persmissions 600 (Scored)'

  at_cron_allow:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/cron.deny':
            tag: 'CIS-6.1.11'
            mode: null
            user: null
            uid: null
            group: null
            gid: null
        - '/etc/at.deny':
            tag: 'CIS-6.1.11'
            mode: null
            user: null
            uid: null
            group: null
            gid: null
        - '/etc/cron.allow':
            tag: 'CIS-6.1.11'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/at/allow':
            tag: 'CIS-6.1.11'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/cron.deny':
            tag: 'CIS-6.1.11'
            mode: null
            user: null
            uid: null
            group: null
            gid: null
        - '/etc/at.deny':
            tag: 'CIS-6.1.11'
            mode: null
            user: null
            uid: null
            group: null
            gid: null
        - '/etc/cron.allow':
            tag: 'CIS-6.1.11'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/at/allow':
            tag: 'CIS-6.1.11'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: 'Restrict at/cron to authorized users (Scored)'

  sshd_config:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/ssh/sshd_config':
            tag: 'CIS-6.2.3'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/ssh/sshd_config':
            tag: 'CIS-6.2.3'
            mode: 600
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/ssh/sshd_config must be owned by root and must have permissions 600 (Scored)'

  warning_banner:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/motd':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/issue':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/issue.net':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/motd':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/issue':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
        - '/etc/issue.net':
            tag: 'CIS-8.1'
            mode: 644
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: 'Files containing the warning banners must be owned by root and must have permissions 644 (Scored)'

  passwd_perm:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/passwd':
            tag: 'CIS-9.1.2'
            mode: 644
      'CentOS Linux-7':
        - '/etc/passwd':
            tag: 'CIS-9.1.2'
            mode: 644
    description: '/etc/passwd must have permissions 644 (Scored)'

  passwd_own:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/passwd':
            tag: 'CIS-9.1.6'
            user: 'root'
            uid: 0
            group: 'root'
            uid: 0
      'CentOS Linux-7':
        - '/etc/passwd':
            tag: 'CIS-9.1.6'
            user: 'root'
            uid: 0
            group: 'root'
            uid: 0
    description: '/etc/passwd must be owned by root (Scored)'

  shadow_perm:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/shadow':
            tag: 'CIS-9.1.3'
            mode: 0
      'CentOS Linux-7':
        - '/etc/shadow':
            tag: 'CIS-9.1.3'
            mode: 0
    description: '/etc/shadow must have permissions 000 (Scored)'

  shadow_own:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/shadow':
            tag: 'CIS-9.1.7'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/shadow':
            tag: 'CIS-9.1.7'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/shadow must be owned by root (Scored)'

  gshadow_perm:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/gshadow':
            tag: 'CIS-9.1.4'
            mode: 0
      'CentOS Linux-7':
        - '/etc/gshadow':
            tag: 'CIS-9.1.4'
            mode: 0
    description: '/etc/gshadow must have permissions 000 (Scored)'

  gshadow_own:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/gshadow':
            tag: 'CIS-9.1.8'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/gshadow':
            tag: 'CIS-9.1.8'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/gshadow must be owned by root (Scored)'

  group_perm:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/group':
            tag: 'CIS-9.1.5'
            mode: 644
      'CentOS Linux-7':
        - '/etc/group':
            tag: 'CIS-9.1.5'
            mode: 644
    description: '/etc/group must have permissions 000 (Scored)'

  group_own:
    data:
      'Red Hat Enterprise Linux Server-6':
        - '/etc/group':
            tag: 'CIS-9.1.9'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
      'CentOS Linux-7':
        - '/etc/group':
            tag: 'CIS-9.1.9'
            user: 'root'
            uid: 0
            group: 'root'
            gid: 0
    description: '/etc/group must be owned by root (Scored)'

grep:
  whitelist:

    fstab_tmp_partition:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.1'
              pattern: '/tmp'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.1'
              pattern: '/tmp'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.1'
              pattern: '/tmp'
      description: 'Create Separate Partition for /tmp (Scored)'

    fstab_tmp_partition_nodev:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.2'
              pattern: '/tmp'
              match_output: 'nodev'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.2'
              pattern: '/tmp'
              match_output: 'nodev'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.2'
              pattern: '/tmp'
              match_output: 'nodev'
      description: 'Set nodev option for /tmp Partition (Scored)'

    fstab_tmp_partition_nosuid:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.3'
              pattern: '/tmp'
              match_output: 'nosuid'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.3'
              pattern: '/tmp'
              match_output: 'nosuid'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.3'
              pattern: '/tmp'
              match_output: 'nosuid'
      description: 'Set nosuid option for /tmp Partition (Scored)'

    fstab_tmp_partition_noexec:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.4'
              pattern: '/tmp'
              match_output: 'noexec'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.4'
              pattern: '/tmp'
              match_output: 'noexec'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.4'
              pattern: '/tmp'
              match_output: 'nosuid'
      description: 'Set noexec option for /tmp Partition (Scored)'

    fstab_var_partition:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.5'
              pattern: '/var'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.5'
              pattern: '/var'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.5'
              pattern: '/var'
      description: 'Create Separate Partition for /var (Scored)'

    fstab_var_tmp_bind_mount:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.6'
              pattern: '/tmp'
              match_output: '/var/tmp'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.6'
              pattern: '/tmp'
              match_output: '/var/tmp'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.6'
              pattern: '/var'
              match_output: '/var/tmp'
      description: 'Bind Mount the /var/tmp directory to /tmp (Scored)'

    fstab_var_log_partition:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.7'
              pattern: '/var/log'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.7'
              pattern: '/var/log'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.7'
              pattern: '/var/log'
      description: 'Create Separate Partition for /var/log (Scored)'

    fstab_var_log_audit_partition:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.8'
              pattern: '/var/log/audit'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.8'
              pattern: '/var/log/audit'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.8'
              pattern: '/var/log/audit'
      description: 'Create Separate Partition for /var/log/audit (Scored)'

    fstab_home_partition:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.9'
              pattern: '/home'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.9'
              pattern: '/home'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.9'
              pattern: '/home'
      description: 'Create Separate Partition for /home (Scored)'

    fstab_home_partition_nodev:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.10'
              pattern: '/home'
              match_output: 'nodev'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.10'
              pattern: '/home'
              match_output: 'nodev'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.10'
              pattern: '/home'
              match_output: 'nodev'
      description: 'Add nodev Option to /home (Scored)'

    fstab_dev_shm_partition_nodev:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.14'
              pattern: '/dev/shm'
              match_output: 'nodev'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.14'
              pattern: '/dev/shm'
              match_output: 'nodev'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.14'
              pattern: '/dev/shm'
              match_output: 'nodev'
      description: 'Add nodev Option to /dev/shm Partition (Scored)'

    fstab_dev_shm_partition_nosuid:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.15'
              pattern: '/dev/shm'
              match_output: 'nosuid'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.15'
              pattern: '/dev/shm'
              match_output: 'nosuid'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.15'
              pattern: '/dev/shm'
              match_output: 'nosuid'
      description: 'Add nosuid Option to /dev/shm Partition (Scored)'

    fstab_dev_shm_partition_noexec:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/fstab':
              tag: 'CIS-1.1.16'
              pattern: '/dev/shm'
              match_output: 'noexec'
        CentOS Linux-7:
          - '/etc/fstab':
              tag: 'CIS-1.1.16'
              pattern: '/dev/shm'
              match_output: 'noexec'
        Ubuntu-14.04:
          - '/etc/fstab':
              tag: 'CIS-2.16'
              pattern: '/dev/shm'
              match_output: 'noexec'
      description: 'Add noexec Option to /dev/shm Partition (Scored)'

    activate_gpg_check:
      data:
        Red Hat Enterprise Linux Server-6:
          - '/etc/yum.conf':
              tag: 'CIS-1.2.3'
              pattern: 'gpgcheck'
              match_output: 'gpgcheck=1'
        CentOS Linux-7:
          - '/etc/yum.conf':
              tag: 'CIS-1.2.2'
              pattern: 'gpgcheck'
              match_output: 'gpgcheck=1'
      description: 'Verify that gpgcheck is Globally Activated (Scored)'

    boot_loader_passwd:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/grub.conf':
              tag: 'CIS-1.5.3'
              pattern: '^password'
        CentOS Linux-7:
          - '/boot/grub2/grub.cfg':
              tag: 'CIS-1.5.3'
              pattern: '^password'
      description: 'Set Boot Loader Password (Scored)'

    restrict_core_dumps:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/security/limits.conf':
              tag: 'CIS-1.6.1'
              pattern: 'hard core'
        CentOS Linux-7:
          - '/etc/security/limits.conf':
              tag: 'CIS-1.6.1'
              pattern: 'hard core'
      description: 'Restrict Core Dumps (Scored)'

    set_daemon_umask:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/sysconfig/init':
              tag: 'CIS-3.1'
              pattern: 'umask'
              match_output: 'umask 027'
        CentOS Linux-7:
          - '/etc/sysconfig/init':
              tag: 'CIS-3.1'
              pattern: 'umask'
              match_output: 'umask 027'
      description: 'Set Daemon umask (Scored)'

    configure_ntp:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ntp.conf':
              tag: 'CIS-3.6'
              pattern: 'restrict default'
          - '/etc/ntp.conf':
              tag: 'CIS-3.6'
              pattern: 'restrict -6 default'
        CentOS Linux-7:
          - '/etc/ntp.conf':
              tag: 'CIS-3.6'
              pattern: 'restrict default'
          - '/etc/ntp.conf':
              tag: 'CIS-3.6'
              pattern: 'restrict -6 default'
      description: 'Configure Network Time Protocol (NTP) (Scored)'

    rsyslog_remote_logging:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/rsyslog.conf':
              tag: 'CIS-5.1.5'
              pattern: "^*.*[^I][^I]*@"
        CentOS Linux-7:
          - '/etc/rsyslog.conf':
              tag: 'CIS-5.1.5'
              pattern: "^*.*[^I][^I]*@"
      description: 'Configure rsyslog to Send Logs to a Remote Log Host (Scored)'

    sshd_protocol_2:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.1'
              pattern: "^Protocol"
              match_output: 'Protocol 2'
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.1'
              pattern: "^Protocol"
              match_output: 'Protocol 2'
      description: 'Set SSH Protocol to 2 (Scored)'

    sshd_loglevel_info:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.2'
              pattern: "^LogLevel"
              match_output: 'LogLevel INFO'
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.2'
              pattern: "^LogLevel"
              match_output: 'LogLevel INFO'
      description: 'Set LogLevel to INFO (Scored)'

    sshd_x11_forwarding:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.4'
              pattern: "^X11Forwarding"
              match_output: 'X11Forwarding no'
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.4'
              pattern: "^X11Forwarding"
              match_output: 'X11Forwarding no'
      description: 'Disable SSH X11 Forwarding (Scored)'

    sshd_max_auth_retries:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.5'
              pattern: "^MaxAuthTries"
              match_output: "MaxAuthTries 4"
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.5'
              pattern: "^MaxAuthTries"
              match_output: "MaxAuthTries 4"
      description: 'Set SSH MaxAuthTries to 4 or Less (Scored)'

    sshd_ignore_rhosts:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.6'
              pattern: "^IgnoreRhosts"
              match_output: "IgnoreRhosts yes"
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.6'
              pattern: "^IgnoreRhosts"
              match_output: "IgnoreRhosts yes"
      description: 'Set SSH IgnoreRhosts to Yes (Scored)'

    sshd_hostbased_auth:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.7'
              pattern: "^HostbasedAuthentication"
              match_output: "HostbasedAuthentication no"
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.7'
              pattern: "^HostbasedAuthentication"
              match_output: "HostbasedAuthentication no"
      description: 'Set SSH HostbasedAuthentication to No (Scored)'

    sshd_disable_root_login:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.8'
              pattern: "^PermitRootLogin"
              match_output: "PermitRootLogin no"
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.8'
              pattern: "^PermitRootLogin"
              match_output: "PermitRootLogin no"
      description: 'Set SSH HostbasedAuthentication to No (Scored)'

    sshd_permit_empty_passwords:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.9'
              pattern: "^PermitEmptyPasswords"
              match_output: "PermitEmptyPasswords no"
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.9'
              pattern: "^PermitEmptyPasswords"
              match_output: "PermitEmptyPasswords no"
      description: 'Set SSH PermitEmptyPasswords to No (Scored)'

    sshd_permit_user_environment:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.10'
              pattern: "^PermitUserEnvironment"
              match_output: "PermitUserEnvironment no"
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.10'
              pattern: "^PermitUserEnvironment"
              match_output: "PermitUserEnvironment no"
      description: 'Do Not Allow Users to Set Environment Options (Scored)'

    sshd_approved_cipher:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.11'
              pattern: "Ciphers"
              match_output: "Ciphers aes128-ctr,aes192-ctr,aes256-ctr"
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.11'
              pattern: "Ciphers"
              match_output: "Ciphers aes128-ctr,aes192-ctr,aes256-ctr"
      description: 'Use Only Approved Cipher in Counter Mode (Scored)'

    sshd_idle_timeout:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.12'
              pattern: "^ClientAliveInterval"
              match_output: "ClientAliveInterval 300"
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.12'
              pattern: "^ClientAliveCountMax"
              match_output: "ClientAliveCountMax 0"
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.12'
              pattern: "^ClientAliveInterval"
              match_output: "ClientAliveInterval 300"
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.12'
              pattern: "^ClientAliveCountMatch"
              match_output: "ClientAliveCountMatch 0"
      description: 'Set Idle Timeout Interval for User Login (Scored)'

    sshd_limit_access:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.13'
              pattern: "^AllowUsers"
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.13'
              pattern: "^AllowGroups"
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.13'
              pattern: "^DenyUsers"
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.13'
              pattern: "^DenyGroups"
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.13'
              pattern: "^AllowUsers"
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.13'
              pattern: "^AllowGroups"
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.13'
              pattern: "^DenyUsers"
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.13'
              pattern: "^DenyGroups"
      description: 'Limit Access via SSH (Scored)'

    sshd_banner:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.14'
              pattern: "^Banner"
        CentOS Linux-7:
          - '/etc/ssh/sshd_config':
              tag: 'CIS-6.2.14'
              pattern: "^Banner"
      description: 'Set SSH Banner (Scored)'

    # NOTE: Need to update this entry to reflect your organization's password policy
    pam_cracklib_try_first_pass:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/pam.d/system-auth':
              tag: 'CIS-6.3.2'
              pattern: "pam_cracklib.so"
              match_output: "try_first_pass"  # allow retrieval from previous stacked PAM module
          - '/etc/pam.d/system-auth':
              tag: 'CIS-6.3.2'
              pattern: "pam_cracklib.so"
              match_output: "retry=3"     # Number of tries before failure
          - '/etc/pam.d/system-auth':
              tag: 'CIS-6.3.2'
              pattern: "pam_cracklib.so"
              match_output: "minlen=14"   # min password lenghth
          - '/etc/pam.d/system-auth':
              tag: 'CIS-6.3.2'
              pattern: "pam_cracklib.so"
              match_output: "dcredit=-1"  # must have at least 1 digit
          - '/etc/pam.d/system-auth':
              tag: 'CIS-6.3.2'
              pattern: "pam_cracklib.so"
              match_output: "ucredit=-1"  # must have at lesat 1 uppercase
          - '/etc/pam.d/system-auth':
              tag: 'CIS-6.3.2'
              pattern: "pam_cracklib.so"
              match_output: "ocredit=-1"  # must have at least 1 special char
          - '/etc/pam.d/system-auth':
              tag: 'CIS-6.3.2'
              pattern: "pam_cracklib.so"
              match_output: "lcredit=-1"  # must have at least 1 lowercase
      description: 'PAM cracklib policy (Scored)'

    # NOTE: Need to update this entry to reflect your organization's password policy
    limit_password_reuse:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/pam.d/system-auth':
              tag: 'CIS-6.3.4'
              pattern: "pam_unix.so"
              match_output: "remember=5"  # number of passwords to remember
        'CentOS Linux-7':
          - '/etc/pam.d/system-auth':
              tag: 'CIS-6.3.4'
              pattern: "pam_unix.so"
              match_output: "remember=5"  # number of passwords to remember
      description: 'PAM Password Reuse (Scored)'

    limit_su_command_access:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/pam.d/su':
              tag: 'CIS-6.5'
              pattern: "pam_wheel.so"
              match_output: "use_uid"  # number of passwords to remember
          - '/etc/group':
              tag: 'CIS-6.5'
              pattern: "wheel"
        'CentOS Linux-7':
          - '/etc/pam.d/su':
              tag: 'CIS-6.5'
              pattern: "pam_wheel.so"
              match_output: "use_uid"  # number of passwords to remember
          - '/etc/group':
              tag: 'CIS-6.5'
              pattern: "wheel"
      description: 'Limit su command access (Scored)'

    passwd_expiration_days:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/login.defs':
              tag: 'CIS-7.1.1'
              pattern: "PASS_MAX_DAYS"
              match_output: "90"
        CentOS Linux-7:
          - '/etc/login.defs':
              tag: 'CIS-7.1.1'
              pattern: "PASS_MAX_DAYS"
              match_output: "90"
      description: 'Set Password Expiration Days (Scored)'

    passwd_change_min_days:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/login.defs':
              tag: 'CIS-7.1.2'
              pattern: "PASS_MIN_DAYS"
              match_output: "7"
        CentOS Linux-7:
          - '/etc/login.defs':
              tag: 'CIS-7.1.2'
              pattern: "PASS_MIN_DAYS"
              match_output: "7"
      description: 'Set Password Change Minimum Number of Days (Scored)'

    passwd_expiry_warning:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/login.defs':
              tag: 'CIS-7.1.3'
              pattern: "PASS_WARN_AGE"
              match_output: "7"
        CentOS Linux-7:
          - '/etc/login.defs':
              tag: 'CIS-7.1.3'
              pattern: "PASS_WARN_AGE"
              match_output: "7"
      description: 'Set Password Expiring Warning Days (Scored)'

    default_umask:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/bashrc':
              tag: 'CIS-7.4'
              pattern: "^umask 077"
          - '/etc/profile.d/*':
              tag: 'CIS-7.4'
              pattern: "^umask 077"
        CentOS Linux-7:
          - '/etc/bashrc':
              tag: 'CIS-7.4'
              pattern: "^umask 077"
          - '/etc/profile.d/*':
              tag: 'CIS-7.4'
              pattern: "^umask 077"
      description: 'Set Default umask for Users (Scored)'

  blacklist:
    legacy_passwd_entries_passwd:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/passwd':
              tag: 'CIS-9.2.2'
              pattern: "^+:"
        CentOS Linux-7:
          - '/etc/passwd':
              tag: 'CIS-9.2.2'
              pattern: "^+:"
      description: 'Verify No Legacy "+" Entries Exist in /etc/passwd (Scored)'

    legacy_passwd_entries_shadow:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/shadow':
              tag: 'CIS-9.2.3'
              pattern: "^+:"
        CentOS Linux-7:
          - '/etc/shadow':
              tag: 'CIS-9.2.3'
              pattern: "^+:"
      description: 'Verify No Legacy "+" Entries Exist in /etc/shadow (Scored)'

    legacy_passwd_entries_group:
      data:
        'Red Hat Enterprise Linux Server-6':
          - '/etc/group':
              tag: 'CIS-9.2.4'
              pattern: "^+:"
        CentOS Linux-7:
          - '/etc/group':
              tag: 'CIS-9.2.4'
              pattern: "^+:"
      description: 'Verify No Legacy "+" Entries Exist in /etc/group (Scored)'

sysctl:
  restrict_suid_core_dumps:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'fs.suid_dumpable':
            tag: 'CIS-1.6.1'
            match_output: '0'
    description: 'Restrict SUID Core Dumps (Scored)'

  exec_shield:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'kernel.exec-shield':
            tag: 'CIS-1.6.2'
            match_output: '1'
    description: 'Configure ExecShield (Scored)'

  randomize_va_space:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'kernel.randomize_va_space':
            tag: 'CIS-1.6.3'
            match_output: '2'
      'CentOS Linux-7':
        - 'kernel.randomize_va_space':
            tag: 'CIS-1.6.2'
            match_output: '2'
    description: 'Enable Randomized Virtual Memory Region Placement (Scored)'

  ip_forwarding:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'net.ipv4.ip_forward':
            tag: 'CIS-4.1.1'
            match_output: '0'
      'CentOS Linux-7':
        - 'net.ipv4.ip_forward':
            tag: 'CIS-4.1.1'
            match_output: '0'
    description: 'Disable IP Forwarding (Scored)'

  send_packet_redirect:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'net.ipv4.conf.all.send_redirects':
            tag: 'CIS-4.1.2'
            match_output: '0'
        - 'net.ipv4.conf.default.send_redirects':
            tag: 'CIS-4.1.2'
            match_output: '0'
        - 'net.ipv4.conf.default.send_redirects':
            tag: 'CIS-4.1.2'
            match_output: '0'
      'CentOS Linux-7':
        - 'net.ipv4.conf.all.send_redirects':
            tag: 'CIS-4.1.2'
            match_output: '0'
        - 'net.ipv4.conf.default.send_redirects':
            tag: 'CIS-4.1.2'
            match_output: '0'
    description: 'Disable Send Packet Redirect (Scored)'

  source_routed_packet_acceptance:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'net.ipv4.conf.all.accept_source_route':
            tag: 'CIS-4.2.1'
            match_output: '0'
        - 'net.ipv4.conf.default.accept_source_route':
            tag: 'CIS-4.2.1'
            match_output: '0'
      'CentOS Linux-7':
        - 'net.ipv4.conf.all.accept_source_route':
            tag: 'CIS-4.2.1'
            match_output: '0'
        - 'net.ipv4.conf.default.accept_source_route':
            tag: 'CIS-4.2.1'
            match_output: '0'
    description: 'Disable Source Routed Packet Acceptance (Scored)'

  icmp_redirect_acceptance:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'net.ipv4.conf.all.accept_redirects':
            tag: 'CIS-4.2.2'
            match_output: '0'
        - 'net.ipv4.conf.default.accept_redirects':
            tag: 'CIS-4.2.2'
            match_output: '0'
      'CentOS Linux-7':
        - 'net.ipv4.conf.all.accept_redirects':
            tag: 'CIS-4.2.2'
            match_output: '0'
        - 'net.ipv4.conf.default.accept_redirects':
            tag: 'CIS-4.2.2'
            match_output: '0'
    description: 'Disable ICMP Redirect Acceptance (Scored)'

  secure_icmp_redirect_acceptance:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'net.ipv4.conf.all.secure_redirects':
            tag: 'CIS-4.2.3'
            match_output: '0'
        - 'net.ipv4.conf.default.secure_redirects':
            tag: 'CIS-4.2.3'
            match_output: '0'
      'CentOS Linux-7':
        - 'net.ipv4.conf.all.secure_redirects':
            tag: 'CIS-4.2.3'
            match_output: '0'
        - 'net.ipv4.conf.default.secure_redirects':
            tag: 'CIS-4.2.3'
            match_output: '0'
    description: 'Disable Secure ICMP Redirect Acceptance (Scored)'

  log_suspicious_packets:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'net.ipv4.conf.all.log_martians':
            tag: 'CIS-4.2.4'
            match_output: '1'
        - 'net.ipv4.conf.default.log_martians':
            tag: 'CIS-4.2.4'
            match_output: '1'
      'CentOS Linux-7':
        - 'net.ipv4.conf.all.log_martians':
            tag: 'CIS-4.2.4'
            match_output: '1'
        - 'net.ipv4.conf.default.log_martians':
            tag: 'CIS-4.2.4'
            match_output: '1'
    description: 'Log Suspicious Activity (Scored)'

  ignore_broadcast_requests:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'net.ipv4.icmp_echo_ignore_broadcasts':
            tag: 'CIS-4.2.5'
            match_output: '1'
      'CentOS Linux-7':
        - 'net.ipv4.icmp_echo_ignore_broadcasts':
            tag: 'CIS-4.2.5'
            match_output: '1'
    description: 'Enable Ignore Broadcast Requests (Scored)'

  bad_error_message_protection:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'net.ipv4.icmp_ignore_bogus_error_responses':
            tag: 'CIS-4.2.6'
            match_output: '1'
      'CentOS Linux-7':
        - 'net.ipv4.icmp_ignore_bogus_error_responses':
            tag: 'CIS-4.2.6'
            match_output: '1'
    description: 'Enable Bad Error Message Protection (Scored)'

  tcp_syn_cookies:
    data:
      'Red Hat Enterprise Linux Server-6':
        - 'net.ipv4.tcp_syncookies':
            tag: 'CIS-4.2.8'
            match_output: '1'
      'CentOS Linux-7':
        - 'net.ipv4.tcp_syncookies':
            tag: 'CIS-4.2.8'
            match_output: '1'
    description: 'Enable TCP SYN cookies (Scored)'

service:
  # Must be installed, no version checking (yet)
  whitelist:
    iptables_running:             # best practice to verify the process is running
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'iptables': 'CIS-4.7_running'
      description: 'rsyslogd should be running'

    rsyslogd_running:             # best practice to verify the process is running
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'rsyslogd': 'CIS-5.1.2_running'
      description: 'rsyslogd should be running'

    auditd_running:             # best practice to verify the process is running
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'auditd': 'CIS-5.2_running'
      description: 'auditd should be running'

    anacron_running:             # best practice to verify the process is running
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'cronie-anacron': 'CIS-6.1.1_running'
      description: 'anacron should be running'

    crond_running:             # best practice to verify the process is running
      data:
        'Red Hat Enterprise Linux Server-6':
          - 'crond': 'CIS-6.1.2_running'
      description: 'crond should be running'
